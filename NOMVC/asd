<?php
// Obtenemos parámetros de URL
$controller = $_GET['controller'] ?? null;
$action     = $_GET['action'] ?? null;

// Si no hay controlador → mostramos menú principal
if ((!$controller && !$action)): 
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="title" content="Portfolio Herrera Gonzalo">
    <title>Portfolio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Panel de Administración del Portfolio</h1>
        <div class="menu">
            <a href="index.php?controller=proyecto&action=index">📁 Proyectos</a>
            <a href="index.php?controller=tecnologia&action=index">⚙️ Tecnologías</a>
            <a href="index.php?controller=txp&action=index">🔗 Asignar Tecnologías</a>
            <a href="index.php?controller=userview&action=index">🌐 Vista Pública</a>
    </div>
    
    <footer>Pagina :3</footer>
</body>
</html>
<?php
else:
    $controllerName = ucfirst($controller) . "Controller";
    $controllerFile = __DIR__ . "/controllers/{$controllerName}.php";

    if (file_exists($controllerFile)) {
        require_once $controllerFile;

        if (class_exists($controllerName)) {
            $objController = new $controllerName();

            if (method_exists($objController, $action)) {
                if ($_SERVER['REQUEST_METHOD'] === 'POST') {
                    $objController->$action($_POST);
                } elseif (isset($_GET['id'])) {
                    $objController->$action($_GET['id']);
                } else {
                    $objController->$action();
                }
            } else {
                echo "Acción '$action' no encontrada en el controlador '$controllerName'.";
            }
        } else {
            echo "Clase '$controllerName' no encontrada en el archivo.";
        }
    } else {
        echo "Controlador '$controllerName' no encontrado.";
    }
endif;
?>